# pycrocosm

OSM Map server API 0.6 implemented using Django. It depends on submodule https://github.com/TimSC/pgmap to handle the PostGIS database.

Installation
------------

Installation is described for Linux Mint 18.2, but should work on similar systems like Debian, Ubuntu Xenial or later.

   cd <src>

   sudo apt install git virtualenv python-pip swig g++ python-dev libpqxx-dev rapidjson-dev libexpat1-dev

   git clone --recursive https://github.com/TimSC/pycrocosm.git

   virtualenv --python=/usr/bin/python pgmapenv

   source pgmapenv/bin/activate

Unhelpfully, django-oauth-plus 2.2.9 (latest at time of writing) is not compatible with Django 1.11.6. I've also added some fixes for JOSM quirks, so compile it from source:

   wget https://bitbucket.org/TimSCUK/django-oauth-plus/get/pluspr19.tar.gz

   tar xvf pluspr19.tar.gz

   cd TimSCUK-django-oauth-plus-.... 

   python setup.py install

   cd ..

Install the rest of the dependencies

   pip install django djangorestframework defusedxml psycopg2 oauth2

   cd pycrocosm/pgmap/

   python setup.py install

   cd ..

   cp pycrocosm/settings.py.template pycrocosm/settings.py

At this stage, you need to configure and initialize the PostGIS database using the tools included in https://github.com/TimSC/pgmap, mainly osm2csv and admin.

To complete the webserver installation, update pycrocosm.settings with details of your database. If you want to access the site from other computers, ALLOWED_HOSTS needs to be set as well. In production, change DEBUG to false and generate a new SECRET_KEY.

   python manage.py makemigrations

   python manage.py migrate

   python manage.py runserver

